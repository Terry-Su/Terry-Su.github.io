{"pathnameRoot":"/","authorUrl":"https://github.com/Terry-Su","locale":"en","logoTitle":"Terry Su","noteIsAutoTranslated":"This page is translated automatically.","copyright":{"left":"Copyright © 2017-","center":"Terry Su","right":"ALL RIGHTS RESERVED"},"blogGithub":"https://github.com/Terry-Su/blogs","id":"understand-and-make-the-debounce","title":"Understand and Make the Debounce","path":"Technology/FrontEnd/JavaScript","route":"/understand-and-make-the-debounce","text":"\n\nconst layoutProps = {\n  \n};\nclass MDXContent extends React.Component {\n  constructor(props) {\n    super(props)\n    this.layout = null\n  }\n  render() {\n    const { components, ...props } = this.props\n\n    return <MDXTag\n             name=\"wrapper\"\n             \n             components={components}><MDXTag name=\"p\" components={components}>{`Anti-shake (de-shake) and throttling (shunt) may not be used much in daily development, but they are useful in certain scenarios. This article mainly discusses anti - shake, mirror article：`}<MDXTag name=\"a\" components={components} parentName=\"p\" props={{\"href\":\"https://terry-su.github.io/understand-and-make-the-throttle\"}}>{`The throttle - Understanding, practice and implementation`}</MDXTag>{`。Discuss shake control and throttling separately，The main purpose is to let some readers who are not familiar with anti - shake throttle can be targeted, master them one by one。`}<MDXTag name=\"br\" components={components} parentName=\"p\"></MDXTag>{`\n`}{`If you have`}<MDXTag name=\"strong\" components={components} parentName=\"p\">{`Two modes`}</MDXTag>{`（It's confusing）：Delay execution and direct execution. More on this later.`}<MDXTag name=\"br\" components={components} parentName=\"p\"></MDXTag>{`\n`}{`The other key point is if you implement it in code. In this paper, step by step, first to achieve a simple case as an example, draw a flowchart, and then according to the flow chart logic to write anti-shake function code.`}</MDXTag>\n<MDXTag name=\"h2\" components={components}>{`Typical cases`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`Take the search button commonly used in daily development as an example. If the user clicks the search button once and accidentally \"shakes\" the button again soon, the anti-shake can avoid the second or even more searches.`}</MDXTag>\n<iframe src=\"https://terry-su.github.io/BlogCDN/iframes/js/debounce/search/index.html?mode=result\" ></iframe>\n<MDXTag name=\"p\" components={components}>{`The first search button does nothing to prevent shaking.`}<MDXTag name=\"br\" components={components} parentName=\"p\"></MDXTag>{`\n`}{`Search button A is the first anti-shake mode: delay execution. If the user clicks several times in a row, and only the last click ends, the search will be executed after a time delay.`}<MDXTag name=\"br\" components={components} parentName=\"p\"></MDXTag>{`\n`}{`Search button B for the second anti - shake mode: direct execution. If the user clicks quickly multiple times in a row, only the first click will perform the search.`}</MDXTag>\n<MDXTag name=\"h2\" components={components}>{`What is anti-shake`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`Combined with the above case, the anti-shake can be understood as: after triggering events for many times, the event handler only executes once.\nAnd the two modes of anti - shake can be applied according to the actual situation.`}</MDXTag>\n<MDXTag name=\"h2\" components={components}>{`Application scenarios`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`Type a text search in real time in the search box`}</MDXTag>\n<iframe src=\"https://terry-su.github.io/BlogCDN/iframes/js/debounce/realtime-search/index.html?mode=result\" ></iframe>\n<MDXTag name=\"p\" components={components}>{`Prevent frequent clicking of the search button from triggering a search request`}</MDXTag>\n<iframe src=\"https://terry-su.github.io/BlogCDN/iframes/js/debounce/standard-search/index.html?mode=result\" ></iframe>\n<MDXTag name=\"h2\" components={components}>{`Step by step handwriting anti - shake`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`Next we comb through a case to achieve the idea of anti - shake.`}<MDXTag name=\"br\" components={components} parentName=\"p\"></MDXTag>{`\n`}{`Suppose we want to implement the function of the search button A in the first example of this article. First, sort out the requirements：\n1. When the search button is clicked, the function does not execute immediately, but rather waits a while to execute.\n2. If the button is clicked again during this time, the timer starts again and waits for the same time before executing. `}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`There are two methods of implementation, the first is recommended, using a timer (setTimeout) to simplify the code, focus on the implementation of the logic of the anti-shake.`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`Method one core parameter：\n1. The waiting time\n2. The timer`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`Draw a flowchart for method 1：`}</MDXTag>\n<MDXTag name=\"pre\" components={components}><MDXTag name=\"code\" components={components} parentName=\"pre\" props={{}}>{`graph TB\nstart--> A{Whether the timer is empty}\nA--> |is| B(add timer: After the The waiting time after, Perform the search and then Clear timer)\nA--> |no| C(Clear timer)\nC--> B\nB--> 结束\n`}</MDXTag></MDXTag>\n<MDXTag name=\"p\" components={components}>{`According to the flow of ideas to achieve method 1 anti - shake code：`}</MDXTag>\n<MDXTag name=\"pre\" components={components}><MDXTag name=\"code\" components={components} parentName=\"pre\" props={{\"className\":\"language-js\"}}>{`function debounce( func, wait = 0 ) {\n  let timer\n  \n  function debounced( ...args ) {\n    const self = this\n    if ( timer == null ) {\n      addTimer()\n      return\n    }\n\n    if ( timer != null ) {\n      clearTimer()\n      addTimer()\n      return\n    }\n\n    function addTimer() {\n      timer = setTimeout( () => {\n        invokeFunc()\n        clearTimer()\n      }, wait )\n    }\n\n    function invokeFunc() {\n      func.apply( self, args )\n    }\n  }\n\n  return debounced\n\n  function clearTimer() {\n    clearTimeout( timer )\n    timer = null\n  }\n}\n`}</MDXTag></MDXTag>\n<MDXTag name=\"p\" components={components}>{`Method two core parameters：\n1. The waiting time\n2. Earliest executable time`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`Draw a flowchart of method 2：`}</MDXTag>\n<MDXTag name=\"pre\" components={components}><MDXTag name=\"code\" components={components} parentName=\"pre\" props={{}}>{`graph TB\nstart --> IF1{Earliest executable time Whether the definition}\nIF1 --> |is| IF2{The current time Whether or not Greater than or equal to Earliest executable time}\nIF1 --> |no| A(Set up the Earliest executable time for The current time add The waiting time)\nIF2 --> |is| B(Perform a search)\nIF2 --> |no| A\n\nB --> The end of the\nA --> The end of the\n`}</MDXTag></MDXTag>\n<MDXTag name=\"p\" components={components}>{`According to the flow chart to achieve method two anti - shake code：`}</MDXTag>\n<MDXTag name=\"pre\" components={components}><MDXTag name=\"code\" components={components} parentName=\"pre\" props={{\"className\":\"language-js\"}}>{`function debounce( func, wait = 0 ) {\n  // Earliest time when func can be invoked\n  let earliest\n  \n  function debounced( ...args ) {\n    const self = this\n    \n    if ( typeof earliest === 'undefined' ) {\n      setEarliset()\n    }\n\n    if ( typeof earliest !== 'undefined' ) {\n      if ( now() >= earliest ) {\n        invokeFun()\n      } else {\n        setEarliset()\n      }\n    }\n\n    function setEarliset() {\n      earliest = now() + wait\n    }\n\n    function invokeFun() {\n      func.apply( self, args )\n    }\n  }\n\n  return debounced\n\n  function now() {\n    return +new Date()\n  }\n}\n`}</MDXTag></MDXTag>\n<MDXTag name=\"p\" components={components}>{`Similarly, we can implement the search button B in a similar way.\nRequirements describe：\n1. After clicking the search button, the function executes immediately. A function cannot be executed until it has been clicked after a period of time.\n2. If the button is clicked during this time, the timer is reset.`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`Core parameters:\n1. The waiting time\n2. The timer`}</MDXTag>\n<MDXTag name=\"pre\" components={components}><MDXTag name=\"code\" components={components} parentName=\"pre\" props={{}}>{`graph TB\nstart--> IF1{Whether the timer is empty}\nIF1 --> |is| B(Perform a search)\nB--> C(Add timer: After the The waiting time after, Clear timer)\n\n\nIF1 --> |no|D(Clear timer)\nD--> C\n\nC--> The end of the\n`}</MDXTag></MDXTag>\n<MDXTag name=\"pre\" components={components}><MDXTag name=\"code\" components={components} parentName=\"pre\" props={{\"className\":\"language-js\"}}>{`function debounce( func, wait = 0 ) {\n  let timer\n  \n  function debounced( ...args ) {\n    const self = this\n\n    timer == null && invokeFunc()\n\n    timer != null && clearTimer()\n    \n    timer = setTimeout( clearTimer, wait )\n\n    function invokeFunc() {\n      func.apply( self, args )\n    }\n  }\n\n  return debounced\n\n  function clearTimer() {\n    clearTimeout( timer )\n    timer = null\n  }\n}\n`}</MDXTag></MDXTag>\n<MDXTag name=\"p\" components={components}>{`Now let's test the first case using the debounce function I wrote earlier`}</MDXTag>\n<iframe src=\"https://terry-su.github.io/BlogCDN/iframes/js/debounce/test-search/index.html?mode=js\" ></iframe>\n<MDXTag name=\"h2\" components={components}>{`conclusion`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`Anti-shake is a high-order function that can combine multiple event functions into one. It is useful in such cases as \"resize window\", \"search for typed text in the search box in real time\", \"scroll bar\" and \"prevent search button from frequently clicking to trigger redundant requests\".`}</MDXTag>\n<MDXTag name=\"h2\" components={components}>{`link`}</MDXTag>\n<MDXTag name=\"ul\" components={components}>\n<MDXTag name=\"li\" components={components} parentName=\"ul\">{`Lodash recommended：`}<MDXTag name=\"a\" components={components} parentName=\"li\" props={{\"href\":\"https://css-tricks.com/debouncing-throttling-explained-examples\"}}>{`https://css-tricks.com/debouncing-throttling-explained-examples`}</MDXTag></MDXTag>\n<MDXTag name=\"li\" components={components} parentName=\"ul\">{`Simple understanding of the definition of anti - shake：`}<MDXTag name=\"a\" components={components} parentName=\"li\" props={{\"href\":\"https://www.cnblogs.com/woodyblog/p/6238445.html\"}}>{`https://www.cnblogs.com/woodyblog/p/6238445.html`}</MDXTag></MDXTag>\n</MDXTag>\n           </MDXTag>\n  }\n}\nMDXContent.isMDXComponent = true\nrender( <MDXContent /> )\n  ","postTime":1537351320000,"comment":2,"isAutoTranslated":true,"availableOtherLocales":["zh_CN"],"componentTextMap":{},"siteTitle":"Understand and Make the Debounce(Terry Su Blog)","siteMetaDescription":"Debounce JavaScript Front End Throttle Understand and Make the Debounce Anti-shake (de-shake) and throttling (shunt) may not be used much in daily development, but they are... (Terry Su Blog)","categoryTitle":"Category","postTimeTitle":"Post Time","reprintingNote":"Author all rights reserved reprint please indicate the source no commercial reprint","endingWords":"Thanks for your reading. If you're from other platforms and like this article, please feel free to add thumb up, collection and sharing on the original platform, so that more people can see this article, which is also the biggest encouragement and support for me!","githubCommentBase":"https://api.github.com/repos/terry-su/blogs/issues/","githubIssuePageBase":"https://github.com/Terry-Su/blogs/issues/","remarkDisqusComment":"https://terrysu.disqus.com/embed.js","texts":{"siteTitle":"Terry Su Blog","siteMetaDescription":"Terry Su's original front-end technology blog 4 years front-end shares popular front-end technology JavaScript ReactJS","categoryNewest":"Latest Blogs","navArticles":"ARTICLES","navAbout":"ABOUT"},"articleTexts":{"endingWords":"Thanks for your reading. If you're from other platforms and like this article, please feel free to add thumb up, collection and sharing on the original platform, so that more people can see this article, which is also the biggest encouragement and support for me!","endingWordsExtra":"**Welcome to [subscribe](https://github.com/Terry-Su/blogs), to read my latest original front end techinique blog.**","qrcodeImageUrl":"","reprintingNote":"Author all rights reserved reprint please indicate the source no commercial reprint","category":"Category","postTime":"Post Time","githubIssuePageBase":"https://github.com/Terry-Su/blogs/issues/","githubCommentBase":"https://api.github.com/repos/terry-su/blogs/issues/","commentOnGithub":"Comment (by Github Issues)"},"markedEndingWordsExtra":"<p><strong>Welcome to <a href=\"https://github.com/Terry-Su/blogs\">subscribe</a>, to read my latest original front end techinique blog.</strong></p>"}
